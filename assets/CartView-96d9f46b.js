import{_ as V,r as _,o as u,c as h,d as e,F as f,f as b,g as x,t as r,b as n,w as y,h as g,v as C,n as p,i as P}from"./index-5c28078a.js";const{VITE_APP_URL:U,VITE_APP_PATH:I}={VITE_APP_URL:"https://vue3-course-api.hexschool.io",VITE_APP_PATH:"harper",BASE_URL:"/vite-deploy-week6hw/",MODE:"production",DEV:!1,PROD:!0},k={data(){return{apiUrl:U,apiPath:I,products:[],productId:"",cart:{},loadingItem:"",form:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{getCart(){this.$http.get(`${this.apiUrl}/v2/api/${this.apiPath}/cart`).then(a=>{console.log("取得購物車:",a.data.data),this.cart=a.data.data})},modifyCart(a){const t={product_id:a.product.id,qty:a.qty};this.loadingItem=a.id,this.$http.put(`${this.apiUrl}/v2/api/${this.apiPath}/cart/${a.id}`,{data:t}).then(d=>{console.log("更新購物車:",d.data),this.getCart(),this.loadingItem=""})},deleteItem(a){this.loadingItem=a.id,this.$http.delete(`${this.apiUrl}/v2/api/${this.apiPath}/cart/${a.id}`).then(t=>{console.log("刪除購物車:",t.data),this.getCart(),this.loadingItem=""})},deleteAllCarts(){const a=`${this.apiUrl}/v2/api/${this.apiPath}/carts`;this.$http.delete(a).then(t=>{alert(t.data.message),this.getCart()}).catch(t=>{alert(t.response.data.message)})},createOrder(){const a=`${this.apiUrl}/v2/api/${this.apiPath}/order`,t=this.form;this.$http.post(a,{data:t}).then(d=>{alert(d.data.message),this.$refs.form.resetForm(),this.getCart()}).catch(d=>{alert(d.response.data.message)})}},mounted(){this.getCart()}},E={class:"text-end"},w={class:"table align-middle"},A=e("thead",null,[e("tr",null,[e("th"),e("th",null,"品名"),e("th",{style:{width:"150px"}},"數量/單位"),e("th",null,"單價")])],-1),q=["onClick","disabled"],T={class:"input-group input-group-sm"},D=["onUpdate:modelValue","disabled","onChange"],S=["value"],$={class:"text-end"},B=e("td",{colspan:"3",class:"text-end"},"總計",-1),L={class:"text-end"},O=e("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),R={class:"text-end text-success"},F={class:"my-5 row justify-content-center"},M={class:"mb-3"},N=e("label",{for:"email",class:"form-label"},"Email",-1),H={class:"mb-3"},j=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),z={class:"mb-3"},G=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),J={class:"mb-3"},K=e("label",{for:"address",class:"form-label"},"收件人地址",-1),Q={class:"mb-3"},W=e("label",{for:"message",class:"form-label"},"留言",-1),X=e("div",{class:"text-end"},[e("button",{type:"submit",class:"btn btn-danger"},"送出訂單")],-1);function Y(a,t,d,Z,l,i){const c=_("v-field"),m=_("error-message"),v=_("v-form");return u(),h(f,null,[e("div",E,[e("button",{class:"btn btn-outline-danger",type:"button",onClick:t[0]||(t[0]=o=>i.deleteAllCarts())},"清空購物車")]),e("table",w,[A,e("tbody",null,[l.cart.carts?(u(!0),h(f,{key:0},b(l.cart.carts,o=>(u(),h("tr",{key:o.id},[e("td",null,[e("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:s=>i.deleteItem(o),disabled:o.id===l.loadingItem}," x ",8,q)]),e("td",null,r(o.product.title),1),e("td",null,[e("div",T,[g(e("select",{name:"",id:"",class:"form-select","onUpdate:modelValue":s=>o.qty=s,disabled:o.id===l.loadingItem,onChange:s=>i.modifyCart(o)},[(u(),h(f,null,b(20,s=>e("option",{value:s,key:s+12345},r(s),9,S)),64))],40,D),[[C,o.qty]])])]),e("td",$,r(o.total),1)]))),128)):x("",!0)]),e("tfoot",null,[e("tr",null,[B,e("td",L,r(l.cart.total),1)]),e("tr",null,[O,e("td",R,r(l.cart.final_total),1)])])]),e("div",F,[n(v,{ref:"form",class:"col-md-6",onSubmit:i.createOrder},{default:y(({errors:o})=>[e("div",M,[N,n(c,{id:"email",name:"email",type:"email",class:p(["form-control",{"is-invalid":o.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:l.form.user.email,"onUpdate:modelValue":t[1]||(t[1]=s=>l.form.user.email=s)},null,8,["class","modelValue"]),n(m,{name:"email",class:"invalid-feedback"})]),e("div",H,[j,n(c,{id:"name",name:"姓名",type:"text",class:p(["form-control",{"is-invalid":o.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:l.form.user.name,"onUpdate:modelValue":t[2]||(t[2]=s=>l.form.user.name=s)},null,8,["class","modelValue"]),n(m,{name:"姓名",class:"invalid-feedback"})]),e("div",z,[G,n(c,{id:"tel",name:"電話",type:"text",class:p(["form-control",{"is-invalid":o.電話}]),placeholder:"請輸入電話",rules:"required|min:8|max:10",modelValue:l.form.user.tel,"onUpdate:modelValue":t[3]||(t[3]=s=>l.form.user.tel=s)},null,8,["class","modelValue"]),n(m,{name:"電話",class:"invalid-feedback"})]),e("div",J,[K,n(c,{id:"address",name:"地址",type:"text",class:p(["form-control",{"is-invalid":o.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:l.form.user.address,"onUpdate:modelValue":t[4]||(t[4]=s=>l.form.user.address=s)},null,8,["class","modelValue"]),n(m,{name:"地址",class:"invalid-feedback"})]),e("div",Q,[W,g(e("textarea",{name:"",id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":t[5]||(t[5]=s=>l.form.message=s)},null,512),[[P,l.form.message]])]),X]),_:1},8,["onSubmit"])])],64)}const te=V(k,[["render",Y]]);export{te as default};
